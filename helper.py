from __future__ import annotations
import typing
import sys
import ctypes
import struct
import mmap


func_code: bytearray = bytearray(
    b'%d\x00%lld\x00%lld\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00AWHc\xc7AVAUATUSH\x83\xec\x08H\x8b\x15\xe0\x12\x00\x00H\x8d\x1c\x82Hc\x039\xf8taH\x8d,\x82\x89\xc1\x8bE\x009\xc1tRHc\xc8L\x8d$\x8aA\x8b\x0c$9\xc8t@Hc\xc1L\x8d,\x82A\x8bE\x009\xc1t-Hc\xc8L\x8d4\x8aA\x8b\x0e9\xc8t\x1bHc\xc1L\x8d<\x82A\x8b\x079\xc1t\n\x89\xc7\xe8\x8f\xff\xff\xffA\x89\x07A\x89\x06A\x89E\x00A\x89\x04$\x89E\x00\x89\x03H\x83\xc4\x08[]A\\A]A^A_\xc3ff.\x0f\x1f\x84\x00\x00\x00\x00\x00f\x90AWI\x89\xd1Hc\xd7AVHc\xc6\x89\xf9AUATUSH\x81\xec\xf8\x00\x00\x00L\x8b\x05%\x12\x00\x00\x89\xbc$\xbc\x00\x00\x00A\x8b\x14\x90H\x8b=\x03\x12\x00\x00L\x8b\x15\x04\x12\x00\x00I\x8d\x1c\x80\xff\xc2\x89\x13L\x8b\x1d\xe5\x11\x00\x00\x89\x0c\x87M\x89\x0c\xc2\x89\x84$\xb8\x00\x00\x00H\x8d\x04@I\x8d\x04\xc3H\x89<$H\x8b8H\x8b@\x08H\x89\x9c$\xa0\x00\x00\x00H\xc1\xe0\x04H\x01\xf8H\x89\xbc$\x80\x00\x00\x00H\x89\x84$\xa8\x00\x00\x00H9\xc7\x0f\x84\x85\x04\x00\x00L\x89\xd8M\x89\xc3M\x89\xd0I\x89\xc2H\x8b\x8c$\x80\x00\x00\x00Hc\x01\x89D$|;\x84$\xbc\x00\x00\x00\x0f\x84>\x04\x00\x00H\x8b\xbc$\xa0\x00\x00\x00I\x8d4\x83\x8b\x1fH\x8bI\x08\x8dS\x01\x89\x16H\x89\xb4$\xb0\x00\x00\x00\x89\\$\x08H\x8b4$\x8b\x9c$\xb8\x00\x00\x00\x89\x1c\x86I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b\x08H\x8b@\x08H\x89L$pH\xc1\xe0\x04H\x01\xc8H\x89\x84$\x98\x00\x00\x00H9\xc1\x0f\x84\xdd\x03\x00\x00H\x8bL$pHc\x01\x89D$x9\x84$\xb8\x00\x00\x00\x0f\x84\xab\x03\x00\x00H\x8b\xb4$\xb0\x00\x00\x00I\x8d\x1c\x83\x8b>H\x8bI\x08\x8dW\x01\x89\x13H\x89\x9c$\x90\x00\x00\x00\x89|$\x08H\x8b\x1c$\x8b|$|\x89<\x83I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b0H\x8b@\x08H\x89t$XH\xc1\xe0\x04H\x01\xf0H\x89\x84$\x88\x00\x00\x00H9\xc6\x0f\x84M\x03\x00\x00H\x8bL$XHc\x01\x89D$D9D$|\x0f\x84\x1e\x03\x00\x00H\x8b\x9c$\x90\x00\x00\x00I\x8d<\x83\x8b\x1bH\x8bI\x08\x8dS\x01\x89\x17H\x89|$h\x8bt$xH\x8b<$\x89\\$\x08\x894\x87I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b\x08H\x8b@\x08H\x89L$0H\xc1\xe0\x04H\x01\xc8H\x89D$`H9\xc1\x0f\x84\xc6\x02\x00\x00L\x89\xd0M\x89\xdaI\x89\xc3H\x8bL$0Hc\x01\x89D$\x149D$x\x0f\x84\x88\x02\x00\x00H\x8b\\$hI\x8d<\x82\x8b\x1bH\x8bI\x08\x8dS\x01\x89\x17H\x89|$P\x8b\\$DH\x8b<$\x89\x1c\x87I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc3H\x8b\x08H\x8b@\x08H\x89L$\x08H\xc1\xe0\x04H\x01\xc8H\x89D$HH9\xc1\x0f\x847\x02\x00\x00M\x89\xc1M\x89\xd0H\x8b|$\x08Hc\x07\x89D$@9D$D\x0f\x84\xff\x01\x00\x00H\x8b\\$PH\x8bO\x08\x8b\x1bI\x8d<\x80\x8dS\x01\x89\x17H\x89|$(\x89\\$\x18H\x8b<$\x8b\\$\x14\x89\x1c\x87I\x89\x0c\xc1H\x8d\x04@I\x8d\x04\xc3L\x8b0H\x8b@\x08H\xc1\xe0\x04L\x01\xf0H\x89D$ I9\xc6\x0f\x84\xaf\x01\x00\x00E\x8b>D9|$\x14\x0f\x84\x92\x01\x00\x00H\x8b|$(I\x8bN\x08\x8b?Ic\xc7\x8dW\x01\x89|$\x18\x8b\\$@H\x8b<$M\x8d\x14\x80A\x89\x12\x89\x1c\x87I\x89\x0c\xc1H\x8d\x04@I\x8d\x04\xc3H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x01\xc8H\x89D$8H9\xc1\x0f\x84C\x01\x00\x00L\x89t$\x18\x8b\x019D$@\x0f\x84\x1e\x01\x00\x00A\x8b2Hc\xd0M\x8d4\x90\xff\xc6H\x8by\x08A\x896H\x8b4$D\x89<\x96I\x89<\xd1H\x8d\x14RI\x8d\x14\xd3H\x8bZ\x08H\x8b*H\xc1\xe3\x04H\x01\xebH9\xdd\x0f\x84\xe0\x00\x00\x00\x8b}\x00A9\xff\x0f\x84\xc7\x00\x00\x00A\x8b6Hc\xd7\xff\xc6L\x8be\x08A\x894\x90H\x8b4$\x89\x04\x96M\x89$\xd1H\x8d\x14RI\x8d\x14\xd3L\x8bb\x08L\x8b*I\xc1\xe4\x04M\x01\xecM9\xe5\x0f\x84\x8d\x00\x00\x00A\x8bu\x009\xf0txI\x8bU\x08\x89\x84$\xec\x00\x00\x00L\x89\x94$\xe0\x00\x00\x00H\x89\x8c$\xd8\x00\x00\x00L\x89\x9c$\xd0\x00\x00\x00L\x89\x8c$\xc8\x00\x00\x00L\x89\x84$\xc0\x00\x00\x00\x89\xbc$\xe8\x00\x00\x00\xe8\xe9\xfb\xff\xff\x8b\x84$\xec\x00\x00\x00L\x8b\x94$\xe0\x00\x00\x00H\x8b\x8c$\xd8\x00\x00\x00L\x8b\x9c$\xd0\x00\x00\x00L\x8b\x8c$\xc8\x00\x00\x00L\x8b\x84$\xc0\x00\x00\x00\x8b\xbc$\xe8\x00\x00\x00\x0f\x1f\x00I\x83\xc5\x10M9\xec\x0f\x85s\xff\xff\xffH\x83\xc5\x10H9\xeb\x0f\x85 \xff\xff\xffH\x83\xc1\x10H9L$8\x0f\x85\xc7\xfe\xff\xffL\x8bt$\x18I\x83\xc6\x10L9t$ \x0f\x85Q\xfe\xff\xffH\x83D$\x08\x10H\x8bD$\x08H9D$H\x0f\x85\xd5\xfd\xff\xffM\x89\xc2M\x89\xc8H\x83D$0\x10H\x8bD$0H9D$`\x0f\x85L\xfd\xff\xffL\x89\xd8M\x89\xd3I\x89\xc2H\x83D$X\x10H\x8bD$XH9\x84$\x88\x00\x00\x00\x0f\x85\xb3\xfc\xff\xffH\x83D$p\x10H\x8bD$pH9\x84$\x98\x00\x00\x00\x0f\x85#\xfc\xff\xffH\x83\x84$\x80\x00\x00\x00\x10H\x8b\x84$\x80\x00\x00\x00H9\x84$\xa8\x00\x00\x00\x0f\x85\x87\xfb\xff\xffH\x81\xc4\xf8\x00\x00\x00[]A\\A]A^A_\xc3\x0f\x1fD\x00\x00UH\x8d=\xe8\xf9\xff\xff1\xc0H\x89\xe5AWAVAUATSH\x83\xe4\xe0H\x83\xec`H\x8d\\$XH\x8b\x15\xd6\xf9\xff\xffH\x89\xdeH\x89\\$0\xff\xd2\x8bD$XH\x8b\x15\xc1\xf9\xff\xffH\x89\xde\x89\x05\xec\x0c\x00\x00H\x8d=\xa1\xf9\xff\xff1\xc0\xff\xd2\x8bD$XHc=\xd6\x0c\x00\x00\x89\x05\xcc\x0c\x00\x00H\x8b\x05\xb5\xf9\xff\xffH\xc1\xe7\x02\xff\xd0H\x89\x05\xb0\x0c\x00\x00Hc\x05\xb5\x0c\x00\x00H\x8b\x15\x9a\xf9\xff\xffH\x8d<@H\xc1\xe7\x03\xff\xd2Hc\x15\x9d\x0c\x00\x00H\x89\x05\x82\x0c\x00\x00\x85\xd2\x0f\x8e\xbf\x00\x00\x00E1\xe4\x0f\x1f\x80\x00\x00\x00\x00H\x8b\x15q\x0c\x00\x00O\x8d,dF\x89$\xa2I\xc1\xe5\x03J\x8d\x1c(H\x8b\x05R\xf9\xff\xff\xbf \x00\x00\x00\xff\xd0H\x89\x03H\xc7C\x08\x00\x00\x00\x00H\x8b\x059\x0c\x00\x00H\xc7C\x10\x08\x00\x00\x00J\x8d\x1c(H\x8bS\x08H\x8bs\x10H\x8dJ\x01E\x89\xe6H9\xf1v@f\x0f\x1f\x84\x00\x00\x00\x00\x00H\x8d\x046H\x89C\x10H\x8b;H\x8b\x05\xf6\xf8\xff\xffH\xc1\xe6\x03\xff\xd0H\x89\x03H\x8b\x05\xee\x0b\x00\x00J\x8d\x1c(H\x8bS\x08H\x8bs\x10H\x8dJ\x01H9\xcer\xc9H\x8b3H\x89K\x08D\x894\x96Hc\x15\xdb\x0b\x00\x00I\xff\xc4D9\xe2\x0f\x8fK\xff\xff\xffH\x8b\x05\xb4\xf8\xff\xffH\x8d<\x95\x00\x00\x00\x00\xff\xd0H\x89\x05\x9b\x0b\x00\x00Hc\x05\xb0\x0b\x00\x00H\x8b\x15\x95\xf8\xff\xffH\x8d<\x80H\xc1\xe7\x05\xff\xd2H\x89\x05t\x0b\x00\x00Hc\x05\x91\x0b\x00\x00H\x8b\x15v\xf8\xff\xffH\x8d<\x80H\xc1\xe7\x04\xff\xd2H\x89\x05M\x0b\x00\x00Hc\x05r\x0b\x00\x00H\x8b\x15W\xf8\xff\xffH\x8d<@H\xc1\xe7\x03\xff\xd2\x8b\x15[\x0b\x00\x00H\x89\x05 \x0b\x00\x00\x85\xd2\x0f\x8e\xab\x00\x00\x00E1\xe4\x0f\x1fD\x00\x00H\x8b\x15!\x0b\x00\x00\xbf\x80\x00\x00\x00B\xc7\x04\xa2\x00\x00\x00\x00K\x8d\x14dL\x8d,\xd0H\x8b\x05\r\xf8\xff\xffJ\x8d\x1c\xa5\x00\x00\x00\x00\xff\xd0I\x89E\x00Hc5\x0c\x0b\x00\x00H\x8b\x15\xe1\n\x00\x00H\x8b\x05\xd2\n\x00\x00I\xc7E\x08\x00\x00\x00\x00I\xc7E\x10\x08\x00\x00\x00I\x89\xf0H\x8d<\xb5\x00\x00\x00\x00J\x8d\x0c\xe2H\x01\xd8H\xc1\xe6\x03\xba\x14\x00\x00\x00\x0f\x1f\x80\x00\x00\x00\x00\xc7\x00\xff\xff\xff\xffH\xc7\x01\x00\x00\x00\x00H\x01\xf8H\x01\xf1\xff\xcau\xe9I\xff\xc4E9\xe0~\x0cH\x8b\x05r\n\x00\x00\xe9]\xff\xff\xff\x8b\x05\x97\n\x00\x00\xc7D$L\x00\x00\x00\x00H\xc7D$8\x00\x00\x00\x00\x85\xc0\x0f\x8e\x9f\x03\x00\x00f\x0f\x1fD\x00\x00L\x8bt$0H\x8b\x15<\xf7\xff\xffL\x89\xf6H\x8d="\xf7\xff\xff1\xc0\xff\xd2H\x8b\x15\'\xf7\xff\xffL\x89\xf6H\x8d=\r\xf7\xff\xff1\xc0D\x8bd$X\xff\xd2\x8b\\$XH\x8b\x15\t\xf7\xff\xffL\x89\xf6H\x8d=\xef\xf6\xff\xff1\xc0\xff\xd2Hc\xc3H\x8b\\$8Hc5 \n\x00\x00H\x01\xd8H\x99H\xf7\xfeHcD$XH\x01\xd8I\x89\xf0I\x89\xd6A\x89\xd7H\x99H\xf7\xfeH\x89\xd1\x89\xd3A\x83\xfc\x01\x0f\x84\x1f\x03\x00\x00A\x83\xfc\x02\x0f\x85\xf2\x02\x00\x00H\x8b5\xd6\t\x00\x00N\x8d\x14\xb6E\x8b\nE9\xce\x0f\x84\xef\x00\x00\x00Ic\xc1L\x8d\x1c\x86A\x8b\x03A9\xc1\x0f\x84\xd9\x00\x00\x00Hc\xd0L\x8d$\x96E\x8b\x0c$D9\xc8\x0f\x84\xc2\x00\x00\x00Ic\xc1H\x8d\x04\x86H\x89D$@\x8b\x00A9\xc1\x0f\x84\xa7\x00\x00\x00Hc\xd0H\x8d<\x96D\x8b\x0fH\x89|$8D9\xc8\x0f\x84\x87\x00\x00\x00Ic\xc1H\x8d\x04\x86H\x89D$(\x8b\x00A9\xc1tlHc\xd0H\x8d<\x96D\x8b\x0fH\x89|$ D9\xc8tPIc\xc1H\x8d\x14\x86\x8b\x02A9\xc1\x0f\x84\x00\t\x00\x00Hc\xf8L\x8d,\xbeE\x8bM\x00D9\xc8t#D\x89\xcfH\x89L$\x10H\x89T$\x18\xe8\x1d\xf6\xff\xffA\x89E\x00H\x8bL$\x10H\x8bT$\x18A\x89\xc1D\x89\nH\x8bD$ D\x89\x08H\x8bD$(D\x89\x08H\x8bD$8D\x89\x08H\x8bD$@D\x89\x08E\x89\x0c$E\x89\x0bE\x89\nL\x8d\x14\x8eA\x8b:9\xf9\x0f\x84\xca\x00\x00\x00Hc\xc7L\x8d\x1c\x86A\x8b\x039\xc7\x0f\x84\xb5\x00\x00\x00Hc\xd0L\x8d$\x96A\x8b<$9\xf8\x0f\x84\x9f\x00\x00\x00Hc\xc7H\x8d\x04\x86H\x89D$@\x8b\x009\xc7\x0f\x84\x85\x00\x00\x00Hc\xd0H\x8d<\x96H\x89|$8\x8b?9\xf8tlHc\xc7H\x8d\x04\x86H\x89D$(\x8b\x009\xc7tSHc\xd0H\x8d\x14\x96\x8b:9\xf8t?Hc\xc7L\x8d,\x86A\x8bE\x009\xc7t.Hc\xf8H\x8d4\xbe\x8b>9\xf8t\x1dH\x89L$\x18H\x89T$ \xe89\xf5\xff\xff\x89\x06H\x8bL$\x18H\x8bT$ \x89\xc7A\x89}\x00\x89:H\x8bD$(\x898H\x8bD$8\x898H\x8bD$@\x898A\x89<$A\x89;A\x89:D9\xcf\x0f\x85\xb2\x07\x00\x00H\x8b\x05\xde\x07\x00\x00\x8b<\x88B9<\xb0D\x0fL\xf9A\x0fL\xdeIc\xd7Hc\xf3\x8b\x14\x90\x8b\x04\xb0E1\xe49\xc2t?)\xc2H\x8b5\xab\x07\x00\x00H\x8b=\x9c\x07\x00\x001\xc0A\x83\xf8\x01\x0f\x85+\x07\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\xa3\xc2s\x0fA\x8d\x0c\x07Hc\xc9D\x8b<\x8fL\x03$\xce\xff\xc0\x83\xf8\x14u\xe5D9\xfbtsH\x8b\x05a\x07\x00\x00H\x8b\x15b\x07\x00\x00\xbe\x13\x00\x00\x00A\x83\xf8\x01\x0f\x85q\x06\x00\x00\x0f\x1f\x00A\x8d<7Hc\xff\x8d\x0c3D\x8b\x04\xb8Hc\xc9D\x8b\x0c\x88A\x83\xf8\xffA\x0f\x94\xc2E9\xc1A\x0f\x94\xc3E\x08\xdau\x17A\x83\xf9\xfft\x11H\x8b<\xfaD\x89\xcbH\x03<\xcaI\x01\xfcE\x89\xc7\x83\xee\x01s\xbbIc\xcfL\x03$\xcaHc\xdbL\x03$\xdaH\x8b\x15\xee\xf3\xff\xffL\x89\xe6H\x8d=\xd4\xf3\xff\xff1\xc0\xff\xd2Hc\x1d\x05\x07\x00\x00J\x8d\x04#H\x99H\xf7\xfbH\x89T$8\xffD$L\x8bD$L9\x05\xe5\x06\x00\x00\x0f\x8fg\xfc\xff\xffH\x8de\xd8[A\\A]A^A_]\xc3H\x89T$@H\x8bt$0H\x8b\x15\x8f\xf3\xff\xff1\xc0H\x8d=y\xf3\xff\xff\xff\xd2L\x8b\x15\xa5\x06\x00\x00H\x8bD$XK\x8d4\xb2H\x89D$(\x8b\x06H\x8bL$@A9\xc6Mc\xdeE\x89\xf0\x0f\x84\xe3\x00\x00\x00Lc\xd8O\x8d\x0c\x9aE\x8b\x01D9\xc0\x0f\x84\xcd\x00\x00\x00Mc\xd8O\x8d$\x9aA\x8b\x04$A9\xc0\x0f\x84\xb6\x00\x00\x00Lc\xd8K\x8d<\x9aD\x8b\x07H\x89|$@D9\xc0\x0f\x84\x9a\x00\x00\x00Ic\xc0I\x8d\x04\x82Lc\x18H\x89D$ E9\xd8t~K\x8d<\x9aH\x89|$\x18\x8b?E\x89\xd8A9\xfbtcHc\xc7I\x8d\x14\x82Hc\x02I\x89\xc09\xc7tGM\x8d,\x82A\x8b}\x009\xf8t8Hc\xc7M\x8d\x1c\x82E\x8b\x03D9\xc7t"D\x89\xc7H\x89L$\x08H\x89T$\x10\xe8\xe5\xf2\xff\xffA\x89\x03H\x8bL$\x08H\x8bT$\x10A\x89\xc0E\x89E\x00Ic\xc0D\x89\x02H\x8b|$\x18I\x89\xc3D\x89\x07H\x8bD$ D\x89\x00H\x8bD$@D\x89\x00E\x89\x04$E\x89\x01D\x89\x06I\x8d4\x8a\x8b>9\xf9\x0f\x84\xd1\x00\x00\x00Hc\xc7M\x8d\x0c\x82A\x8b\x019\xc7\x0f\x84\xbd\x00\x00\x00Hc\xd0M\x8d$\x92A\x8b<$9\xf8\x0f\x84\xa7\x00\x00\x00Hc\xc7I\x8d\x04\x82H\x89D$@\x8b\x009\xc7\x0f\x84\x8d\x00\x00\x00Hc\xd0I\x8d<\x92H\x89|$ \x8b?9\xf8ttHc\xc7I\x8d\x04\x82H\x89D$\x18\x8b\x009\xc7t[Hc\xd0I\x8d<\x92H\x89|$\x10\x8b?9\xf8tBHc\xc7I\x8d\x14\x82\x8b\x029\xc7t.Hc\xf8M\x8d,\xbaA\x8b}\x009\xf8t\x1dH\x89\x0c$H\x89T$\x08\xe8\xfd\xf1\xff\xffA\x89E\x00H\x8b\x0c$H\x8bT$\x08\x89\xc7\x89:H\x8bD$\x10\x898H\x8bD$\x18\x898H\x8bD$ \x898H\x8bD$@\x898A\x89<$A\x899\x89>K\x8d\x14[H\xc1\xe2\x03D9\xc7\x0f\x84\xa4\x03\x00\x00Lc\xcfL\x8b-\x9c\x04\x00\x00K\x8d4IH\xc1\xe6\x03M\x8dd\x15\x00I\x01\xf5H\x89t$ I\x8bD$\x08I\x8bu\x08H9\xf0r#H\x89\xf7H\x89T$ H\x89\xc6H\x89\xf8L\x89\xefM\x89\xcbM\x89\xe5D\x89\xf3I\x89\xfcA\x89\xcfD\x89\xc7M\x8bE\x10H\x8d\x14\x06C\x89<\x9aI\x8b}\x00I9\xd0s7\x90K\x8d\x04\x00I\x89E\x10H\x8b\x05)\xf1\xff\xffJ\x8d4\xc5\x00\x00\x00\x00\xff\xd0I\x89E\x00I\x8bu\x08H\x89\xc7I\x8bD$\x08M\x8bE\x10H\x8d\x14\x06I9\xd0r\xcaH\xc1\xe0\x02I\x89\xc6I\xc1\xee\x02M\x8b\x0c$L\x8d\x04\xb5\x00\x00\x00\x00\x0f\x84\xc2\x00\x00\x00I\x01\xf8M\x8da\x04M\x89\xc3M)\xe3M\x8dV\xffI\x83\xfb\x18\x0f\x86>\x03\x00\x00I\x83\xfa\x02\x0f\x864\x03\x00\x00I\x83\xfa\x06\x0f\x86y\x03\x00\x00I\x89\xc3I\xc1\xeb\x05H\x83\xe0\xe0E1\xd2\xc4\x81~o\x04\x11\xc4\x81~\x7f\x04\x10I\x83\xc2 L9\xd0u\xebJ\x8d\x04\xdd\x00\x00\x00\x00I9\xc6tcM\x89\xf2I)\xc2M\x8dZ\xffI\x83\xfb\x02v\x1d\xc4\xc1zo\x0c\x81H\x01\xc6\xc5\xfa\x7f\x0c\xb7L\x89\xd6H\x83\xe6\xfcH\x01\xf0I9\xf2t6A\x8b<\x81H\x8d4\x85\x00\x00\x00\x00A\x89<0H\x8dx\x01I9\xfev\x1dA\x8b|1\x04H\x83\xc0\x02B\x89|\x06\x04I9\xc6v\nA\x8bD1\x08B\x89D\x06\x08I\x89U\x08Hc\xc3H\x8b5\x15\x03\x00\x00H\x89\xc7\x8b<\xbeH\x89D$\x18\x8dW\x01Ic\xc7\x89\x14\x86H\x8b\x15\xea\x02\x00\x00H\x8b|$(\x89\x1c\x82H\x8b\x15\xe3\x02\x00\x00H\x89<\xc2H\x8b=\xc8\x02\x00\x00H\x8d\x04@L\x8d$\xc7M\x8b4$\xb8\x04\x00\x00\x00\xc4B\xf9\xf7l$\x08K\x8d\x04.H\x89|$\x10H\x89D$@M\x89\xf5I9\xc6t\x1fA\x8bu\x009\xdet\x0cI\x8bU\x08D\x89\xff\xe8V\xf0\xff\xffI\x83\xc5\x10L9l$@u\xe1H\x8bD$\x18H\x8b|$\x10H\x8d\x04@L\x8d,\xc7I\x8bU\x08I\x8bE\x10H\x8dr\x01I\x8b}\x00H9\xc6\x0f\x86#\x02\x00\x00H\x89\xc6\xc5\xf8wf.\x0f\x1f\x84\x00\x00\x00\x00\x00H\x8d\x046I\x89E\x10H\x8b\x05I\xef\xff\xffH\xc1\xe6\x05\xff\xd0I\x8bU\x08I\x8bu\x10I\x89E\x00H\x89\xc7H\x8dB\x01H9\xc6r\xd3M\x8b4$H\x89\xc6I\x89u\x08H\x8bD$(H\xc1\xe2\x04H\x01\xd7I\x8bT$\x08H\x89G\x08I\x8bD$\x10H\x8dJ\x01D\x89?H9\xc1v=H\x89\xc6L\x89\xf7\x0f\x1f@\x00H\x8d\x046I\x89D$\x10H\x8b\x05\xe0\xee\xff\xffH\xc1\xe6\x05\xff\xd0I\x8bT$\x08I\x8bt$\x10H\x8dJ\x01I\x89\x04$H\x89\xc7H9\xcer\xd0I\x89\xc6H\x8bD$(H\xc1\xe2\x04M\x8d\x04\x16I\x89L$\x08I\x89@\x08H\x8bD$ A\x89\x18H\x03\x05\xa0\x01\x00\x00L\x8b(H\x8b@\x08H\x8b=z\x01\x00\x00D\x8b5\x9f\x01\x00\x00L\x8b\x05t\x01\x00\x00H\x85\xc0\x0f\x84\x98\xfa\xff\xffI\x8d\\\x85\x00E1\xdbA\xbc\x13\x00\x00\x00\x0f\x1fD\x00\x00E\x89\xd9L\x89\xeeE\x01\xf3\xeb&\x0f\x1fD\x00\x00D\x01\xc8I\x8b\x0c\xc8H\x98D\x8b<\x87I\x03\x0c\xc0H\x83\xc6\x04E\x89:I\x89\x0c\xd0H9\xf3t+\x8b\x16B\x8d\x0c\nHc\xc9D\x01\xda\x8b\x04\x8fHc\xd2L\x8d\x14\x97\x83\xf8\xffu\xc4H\x83\xc6\x04A\xc7\x02\xff\xff\xff\xffH9\xf3u\xd5A\xff\xccu\x9f\xe9\x1f\xfa\xff\xffH\x89T$ D\x89\xf3A\x89\xcf\xe9\xcb\xfd\xff\xffC\x8d4\xc0E\x8d\x0cpA\xbd\x14\x00\x00\x00\x0f\x1f@\x00C\x8d49Hc\xf6A\x8d\x0c\x19\x8b<\xb0Hc\xc9D\x8b\x14\x88\x83\xff\xffA\x0f\x94\xc3A9\xfaA\x0f\x94\xc6E\x08\xf3u\x17A\x83\xfa\xfft\x11H\x8b4\xf2D\x89\xd3H\x034\xcaI\x01\xf4A\x89\xffE)\xc1A\xff\xcdu\xb9\xe9y\xf9\xff\xff1\xc0A\x8b\x0c\x81A\x89\x0c\x80H\xff\xc0I9\xc6u\xf0\xe9R\xfd\xff\xffE1\xc9f.\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\xa3\xc2s\x0fC\x8d\x0c9Hc\xc9D\x8b<\x8fL\x03$\xce\xff\xc0E\x01\xc1\x83\xf8\x14u\xe2\xe9\xc8\xf8\xff\xff\xc5\xf8w\xe9\x19\xfe\xff\xffM\x89\xf21\xc0\xe9\xbd\xfc\xff\xffI\xc7\xc4\xff\xff\xff\xff\xe9"\xf9\xff\xffA\x89\xc1\xe9.\xf7\xff\xff\x0f\x1f\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
)

libc_relocs: dict[str, int] = dict(
    scanf=0x10,
    printf=0x18,
    free=0x20,
    realloc=0x28,
    malloc=0x30,
)

func_offs: int = 0x610

libc = ctypes.CDLL("libc.so.6")

for name, offs in libc_relocs.items():
    ctypes_func: ctypes._FuncPointer = getattr(libc, name)
    ctypes_func_addr: int = ctypes.c_void_p.from_address(ctypes.addressof(ctypes_func)).value
    
    func_code[offs:offs + 8] = struct.pack("<Q", ctypes_func_addr)
    # print(f"{name} -> {ctypes_func_addr:#x}")
    del ctypes_func, ctypes_func_addr

assert len(func_code) <= 8 * mmap.PAGESIZE, "Payload too big"

# print(func_code.hex())

func_buf = mmap.mmap(-1, len(func_code), prot=mmap.PROT_READ | mmap.PROT_WRITE | mmap.PROT_EXEC)
func_ptr = ctypes.c_void_p.from_buffer(func_buf, func_offs)
func_type = ctypes.CFUNCTYPE(
    None,
)
func = func_type(ctypes.addressof(func_ptr))
func_buf.write(func_code)

# breakpoint()

# Magic
func()