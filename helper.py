from __future__ import annotations
import typing
import sys
import ctypes
import struct
import mmap


func_code: bytearray = bytearray(
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00AUATUSH\x83\xec\x08Hc=C\x11\x00\x00H\x8b\x05\xe0\xff\xff\xffH\xc1\xe7\x02\xff\xd0H\x8b\x15\xd3\xff\xff\xffH\x89\x05\x1c\x11\x00\x00Hc\x05!\x11\x00\x00H\x8d<@H\xc1\xe7\x03\xff\xd2\x8b\x15\x11\x11\x00\x00H\x89\x05\xf6\x10\x00\x00\x85\xd2\x0f\x8e\x99\x00\x00\x00E1\xe4\x0f\x1f\x00H\x8b\x15\xe9\x10\x00\x00K\x8d,d\xbf\x04\x00\x00\x00E\x89\xe5H\xc1\xe5\x03H\x8d\x1c(F\x89$\xa2H\x8b\x05z\xff\xff\xff\xff\xd0f\x0fo\x05\xe8\x10\x00\x00H\x89\x03\x0f\x11C\x08\xeb"\x0f\x1f\x80\x00\x00\x00\x00H\x8d\x046H\x8b;H\xc1\xe6\x03H\x89C\x10H\x8b\x05B\xff\xff\xff\xff\xd0H\x89\x03H\x8b\x05\x86\x10\x00\x00H\x8d\x1c(H\x8bS\x08H\x8bs\x10H\x8dJ\x01H9\xcer\xc9H\x8b3H\x89K\x08I\x83\xc4\x01D\x89,\x96D9%o\x10\x00\x00\x0f\x8fm\xff\xff\xffH\x83\xc4\x08[]A\\A]\xc3f.\x0f\x1f\x84\x00\x00\x00\x00\x00USH\x83\xec\x08H\x8b\x05\xdb\xfe\xff\xffH\x8b=4\x10\x00\x00\xff\xd0\x8b\x058\x10\x00\x00H\x8b=\x1d\x10\x00\x00H\xc7\x05\x1a\x10\x00\x00\x00\x00\x00\x00\x85\xc0~E1\xdb\x0f\x1f@\x00H\x8d\x04[H\x8b\x15\xa5\xfe\xff\xffH\x83\xc3\x01H\x8b<\xc7H\x8d,\xc5\x00\x00\x00\x00\xff\xd2H\x8b=\xe4\x0f\x00\x00f\x0f\xef\xc09\x1d\xee\x0f\x00\x00H\x8d\x04/H\xc7\x00\x00\x00\x00\x00\x0f\x11@\x08\x7f\xc1H\x8b\x05j\xfe\xff\xff\xff\xd0H\xc7\x05\xb5\x0f\x00\x00\x00\x00\x00\x00H\x83\xc4\x08[]\xc3ff.\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\x1f\x00AWHc\xc7AVAUATUSH\x83\xec\x08H\x8b\x15\x90\x0f\x00\x00H\x8d\x1c\x82Hc\x039\xf8taH\x8d,\x82\x89\xc1\x8bE\x009\xc1tRHc\xc8L\x8d$\x8aA\x8b\x0c$9\xc8t@Hc\xc1L\x8d,\x82A\x8bE\x009\xc1t-Hc\xc8L\x8d4\x8aA\x8b\x0e9\xc8t\x1bHc\xc1L\x8d<\x82A\x8b\x079\xc1t\n\x89\xc7\xe8\x8f\xff\xff\xffA\x89\x07A\x89\x06A\x89E\x00A\x89\x04$\x89E\x00\x89\x03H\x83\xc4\x08[]A\\A]A^A_\xc3ff.\x0f\x1f\x84\x00\x00\x00\x00\x00f\x90AWHc\xc7AVI\x89\xc6AUATA\x89\xf4USH\x83\xec\x08H\x8b5\xea\x0e\x00\x00L\x8d\x04\x86A\x8b(9\xe8t=Hc\xc5L\x8d\x0c\x86A\x8b\x019\xc5t,Hc\xd0L\x8d\x14\x96A\x8b*9\xe8t\x1bHc\xc5L\x8d\x1c\x86A\x8b;9\xfdt\n\xe8\x08\xff\xff\xffA\x89\x03\x89\xc5A\x89*A\x89)A\x89(Ic\xc4L\x8d\x04\x86A\x8b\x18A9\xdct=Hc\xc3L\x8d\x0c\x86A\x8b\x019\xc3t,Hc\xd0L\x8d\x14\x96A\x8b\x1a9\xd8t\x1bHc\xc3L\x8d\x1c\x86A\x8b;9\xfbt\n\xe8\xbc\xfe\xff\xffA\x89\x03\x89\xc3A\x89\x1aA\x89\x19A\x89\x189\xeb\x0f\x84\xe6\x00\x00\x00H\x8b\x05?\x0e\x00\x00Hc\xcdHc\xfbH\x8d\x14IL\x8d\x04\x7fL\x8d,\xd0N\x8d<\xc0I\x8bU\x08I\x8bG\x08H9\xc2\x0f\x83\x88\x00\x00\x00\x89\x1c\x8eI\x8bw\x10H\x8d\x0c\x02I\x8b?H9\xces5\x0f\x1fD\x00\x00H\x8d\x046H\xc1\xe6\x03I\x89G\x10H\x8b\x05\x9d\xfc\xff\xff\xff\xd0I\x8bU\x08I\x8bw\x10I\x89\x07H\x89\xc7I\x8bG\x08H\x8d\x0c\x10H9\xcer\xd0H\x8b\ri\xfc\xff\xffI\x8bu\x00H\xc1\xe2\x02H\x8d<\x87\xff\xd1I\x8bE\x08I\x01G\x08H\x83\xc4\x08I\xc1\xe6 D\x89\xe0\x89\xdaH\xc1\xe5 [L\t\xf0H\t\xea]A\\A]A^A_\xc3\x90H\x89\xd1H\x89\xc2H\x89\xc8L\x89\xf9M\x89\xefI\x89\xcdH\x89\xf9\x89\xdf\x89\xeb\x89\xfdD\x89\xe7E\x89\xf4A\x89\xfe\xe9O\xff\xff\xff\x0f\x1f\x80\x00\x00\x00\x00D\x89\xf0E\x89\xe6A\x89\xc4\xeb\xa2\x0f\x1fD\x00\x00AWI\x89\xd1Hc\xd7Hc\xc6AVAUATUSH\x81\xec\x08\x01\x00\x00L\x8b\x05\'\r\x00\x00H\x8b5\x10\r\x00\x00L\x8b\x15\x11\r\x00\x00L\x8b\x1d\xfa\x0c\x00\x00\x89\x84$\xc8\x00\x00\x00A\x8b\x14\x90I\x8d\x1c\x80H\x89t$(\x89\xbc$\xcc\x00\x00\x00\x83\xc2\x01H\x89\x9c$\xb0\x00\x00\x00\x89\x13\x89<\x86M\x89\x0c\xc2H\x8d\x04@I\x8d\x04\xc3H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x89\x8c$\x90\x00\x00\x00H\x01\xc8H\x89\x84$\xb8\x00\x00\x00H9\xc1\x0f\x84\xaf\x04\x00\x00L\x89\xd8M\x89\xc3M\x89\xd0I\x89\xc2H\x8b\x8c$\x90\x00\x00\x00Hc\x01\x89\x84$\x8c\x00\x00\x00;\x84$\xcc\x00\x00\x00\x0f\x84e\x04\x00\x00H\x8b\xb4$\xb0\x00\x00\x00I\x8d<\x83H\x8bI\x08H\x89\xbc$\xc0\x00\x00\x00\x8b\x1e\x8dS\x01\x89\\$\x08\x8b\x9c$\xc8\x00\x00\x00\x89\x17H\x8b|$(\x89\x1c\x87I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x89\x8c$\x80\x00\x00\x00H\x01\xc8H\x89\x84$\xa8\x00\x00\x00H9\xc1\x0f\x84\x00\x04\x00\x00H\x8b\x8c$\x80\x00\x00\x00Hc\x01\x89\x84$\x88\x00\x00\x009\x84$\xc8\x00\x00\x00\x0f\x84\xc2\x03\x00\x00H\x8b\xbc$\xc0\x00\x00\x00I\x8d\x1c\x83H\x8bI\x08H\x89\x9c$\xa0\x00\x00\x00\x8b?\x8dW\x01\x89|$\x08H\x8b|$(\x89\x13\x8b\x9c$\x8c\x00\x00\x00\x89\x1c\x87I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x89L$hH\x01\xc8H\x89\x84$\x98\x00\x00\x00H9\xc1\x0f\x84`\x03\x00\x00H\x8bL$hHc\x01\x89D$T9\x84$\x8c\x00\x00\x00\x0f\x84.\x03\x00\x00H\x8b\xbc$\xa0\x00\x00\x00I\x8d\x1c\x83H\x8bI\x08H\x89\\$x\x8b?\x8dW\x01\x89|$\x08\x8b\xbc$\x88\x00\x00\x00\x89\x13H\x8b\\$(\x89<\x83I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc2H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x89L$8H\x01\xc8H\x89D$pH9\xc1\x0f\x84\xd2\x02\x00\x00L\x89\xd0M\x89\xdaI\x89\xc3H\x8bL$8Hc\x01\x89D$\x149\x84$\x88\x00\x00\x00\x0f\x84\x91\x02\x00\x00H\x8bt$xH\x8bI\x08I\x8d<\x82H\x8b\\$(H\x89|$`\x8b6\x8dV\x01\x8bt$T\x89\x17\x894\x83I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc3H\x8b\x08H\x8b@\x08H\xc1\xe0\x04H\x89L$\x08H\x01\xc8H\x89D$XH9\xc1\x0f\x84?\x02\x00\x00M\x89\xd1H\x8bL$\x08Hc\x01\x89D$P9D$T\x0f\x84\r\x02\x00\x00H\x8b\\$`H\x8bI\x08I\x8d4\x81H\x89t$0\x8b;\x8b\\$\x14\x8dW\x01\x89|$\x18H\x8b|$(\x89\x16\x89\x1c\x87I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc3L\x8b0H\x8b@\x08H\xc1\xe0\x04L\x01\xf0H\x89D$ I9\xc6\x0f\x84\xbc\x01\x00\x00E\x8b>D9|$\x14\x0f\x84\x9f\x01\x00\x00H\x8b|$0Ic\xc7I\x8bN\x08H\x8bt$(M\x8d\x14\x81\x8b\x1f\x8dS\x01\x89\\$\x18\x8b\\$PA\x89\x12\x89\x1c\x86I\x89\x0c\xc0H\x8d\x04@I\x8d\x04\xc3H\x8b8H\x8b@\x08H\xc1\xe0\x04H\x89|$@H\x01\xf8H\x89D$HH9\xc7\x0f\x84J\x01\x00\x00L\x89t$\x18I\x89\xf6H\x8bD$@\x8b\x089L$P\x0f\x84\x16\x01\x00\x00A\x8b2Hc\xd1H\x8bx\x08I\x8d\x04\x91\x83\xc6\x01\x890E\x89<\x96I\x89<\xd0H\x8d\x14RI\x8d\x14\xd3H\x8bZ\x08H\x8b*H\xc1\xe3\x04H\x01\xebH9\xdd\x0f\x84\xdc\x00\x00\x00\x8b}\x00A9\xff\x0f\x84\xc3\x00\x00\x00\x8b0L\x8be\x08Hc\xd7\x83\xc6\x01A\x894\x91A\x89\x0c\x96M\x89$\xd0H\x8d\x14RI\x8d\x14\xd3L\x8bb\x08L\x8b*I\xc1\xe4\x04M\x01\xecM9\xe5\x0f\x84\x8c\x00\x00\x00A\x8bu\x009\xf1twI\x8bU\x08H\x89\x84$\xf8\x00\x00\x00\x89\x8c$\xf4\x00\x00\x00L\x89\x94$\xe8\x00\x00\x00L\x89\x9c$\xe0\x00\x00\x00L\x89\x84$\xd8\x00\x00\x00L\x89\x8c$\xd0\x00\x00\x00\x89\xbc$\xf0\x00\x00\x00\xe8\xc8\xfb\xff\xffH\x8b\x84$\xf8\x00\x00\x00\x8b\x8c$\xf4\x00\x00\x00L\x8b\x94$\xe8\x00\x00\x00L\x8b\x9c$\xe0\x00\x00\x00L\x8b\x84$\xd8\x00\x00\x00L\x8b\x8c$\xd0\x00\x00\x00\x8b\xbc$\xf0\x00\x00\x00f\x90I\x83\xc5\x10M9\xec\x0f\x85t\xff\xff\xffH\x83\xc5\x10H9\xeb\x0f\x85$\xff\xff\xffH\x83D$@\x10H\x8bD$@H9D$H\x0f\x85\xc3\xfe\xff\xffL\x8bt$\x18I\x83\xc6\x10L9t$ \x0f\x85D\xfe\xff\xffH\x83D$\x08\x10H\x8bD$\x08H9D$X\x0f\x85\xc7\xfd\xff\xffM\x89\xcaH\x83D$8\x10H\x8bD$8H9D$p\x0f\x85@\xfd\xff\xffL\x89\xd8M\x89\xd3I\x89\xc2H\x83D$h\x10H\x8bD$hH9\x84$\x98\x00\x00\x00\x0f\x85\xa0\xfc\xff\xffH\x83\x84$\x80\x00\x00\x00\x10H\x8b\x84$\x80\x00\x00\x00H9\x84$\xa8\x00\x00\x00\x0f\x85\x00\xfc\xff\xffH\x83\x84$\x90\x00\x00\x00\x10H\x8b\x84$\x90\x00\x00\x00H9\x84$\xb8\x00\x00\x00\x0f\x85]\xfb\xff\xffH\x81\xc4\x08\x01\x00\x00[]A\\A]A^A_\xc3ff.\x0f\x1f\x84\x00\x00\x00\x00\x00AWAVAUATUSH\x89\xd3H\x83\xec8H\x89T$\x08\xe8\xd5\xf8\xff\xffH\x8b\r\xc6\x07\x00\x00H\x89\xc5\x89D$\x04H\xc1\xf8 Hc\xfdH\x89T$(A\x89\xc7H\x89|$\x10\x8b<\xb9H\x89D$ H\x98\x8dW\x01H\x8b=\x7f\x07\x00\x00\x89\x14\x81H\x8b\x15}\x07\x00\x00H\x89|$\x18\x89,\x82H\x8b\x15v\x07\x00\x00H\x89\x1c\xc2H\x8d\x04@L\x8d$\xc7I\x8b\\$\x08M\x8b4$H\xc1\xe3\x04M\x89\xf5L\x01\xf3I9\xdet\x1fA\x8bu\x009t$\x04t\x0cI\x8bU\x08D\x89\xff\xe8\xfc\xf9\xff\xffI\x83\xc5\x10L9\xebu\xe1H\x8bD$\x10H\x8b|$\x18H\x8d\x04@H\x8d\x1c\xc7H\x8bC\x08H\x8bs\x10H\x8b;H\x8dP\x01H9\xd6s5\x0f\x1fD\x00\x00H\x8d\x046H\xc1\xe6\x05H\x89C\x10H\x8b\x05\xb5\xf5\xff\xff\xff\xd0H\x8bs\x10H\x89\x03H\x89\xc7H\x8bC\x08H\x8dP\x01H9\xd6r\xd4M\x8b4$H\xc1\xe0\x04H\x89S\x08H\x01\xc7\x8bD$ \x89\x07H\x8bD$\x08H\x89G\x08\xeb$\x0f\x1f@\x00H\x8d\x046L\x89\xf7H\xc1\xe6\x05I\x89D$\x10H\x8b\x05a\xf5\xff\xff\xff\xd0I\x89\x04$I\x89\xc6I\x8bD$\x08I\x8bt$\x10H\x8dP\x01H9\xd6r\xcdH\xc1\xe0\x04I\x89T$\x08H\x8b=m\x06\x00\x00M\x8d\x04\x06H\x8bD$\x08A\x89(I\x89@\x08HcD$(L\x8b\x05Y\x06\x00\x00H\x8d\x14@H\x8b\x05^\x06\x00\x00H\x8d\x04\xd0L\x8b\x18H\x8b@\x08H\x85\xc0\x0f\x848\x01\x00\x00M\x8d\x14\x83\x8b\x05T\x06\x00\x00\xbe\x01\x00\x00\x00D\x8dN\xff\x83\xfe\x01\x0f\x85\x8e\x00\x00\x00f\x0f\x1fD\x00\x00L\x89\xde\xeb>\x0f\x1f\x00\x01\xd1H\x83\xc6\x04Hc\xc9\x8b\x0c\x8f\x89\x08\x8b\x05 \x06\x00\x00D\x89\xc9\x0f\xaf\xc8\x8d,\x18Hc\xed\x01\xca\x01\xd9Hc\xd2Hc\xc9I\x8b\x0c\xc8I\x03\x0c\xd0I\x89\x0c\xe8I9\xf2t3D\x89\xc9\x8b\x1e\x0f\xaf\xc8\x01\xd8H\x98\x8d\x14\x19H\x8d\x04\x87Hc\xd2\x8b\x14\x97\x83\xfa\xffu\xa7H\x83\xc6\x04\xc7\x00\xff\xff\xff\xff\x8b\x05\xcb\x05\x00\x00I9\xf2u\xcd\xbe\x02\x00\x00\x00D\x8dN\xff\x83\xfe\x01\x0f\x84x\xff\xff\xffL\x89\xd9\xebE\x0f\x1f\x00\x01\xddH\x83\xc1\x04Hc\xed\x8b,\xaf\x89(\x8b\x05\x98\x05\x00\x00\x89\xc5\x0f\xaf\xc6A\x0f\xaf\xe9\x01\xd0\x01\xea\x01\xddH\x98Hc\xd2Hc\xedI\x8b\x1c\xe8I\x03\x1c\xd0I\x89\x1c\xc0I9\xcat7\x8b\x05j\x05\x00\x00\x89\xc5\x8b\x11\x0f\xaf\xc6A\x0f\xaf\xe9\x01\xd0\x8d\\\x15\x00H\x98Hc\xdbH\x8d\x04\x87\x8b\x1c\x9f\x83\xfb\xffu\x9cH\x83\xc1\x04\xc7\x00\xff\xff\xff\xffI9\xcau\xc9\x83\xc6\x01\x83\xfe\x14t\x0b\x8b\x05+\x05\x00\x00\xe9\xd7\xfe\xff\xffH\x83\xc48[]A\\A]A^A_\xc3\x0f\x1f\x00L\x8b\r\x01\x05\x00\x00AVAUATUSHc\xdfM\x8d\x1c\x99I\x89\xdaE\x8b\x03D9\xc3tFIc\xc0I\x8d,\x81\x8bE\x00A9\xc0t4Hc\xd0M\x8d$\x91E\x8b\x04$D9\xc0t Ic\xc0M\x8d,\x81A\x8b}\x00A9\xf8t\x0c\xe8\x0b\xf5\xff\xffA\x89E\x00A\x89\xc0E\x89\x04$D\x89E\x00E\x89\x03Lc\xdeK\x8d,\x99\x8b}\x009\xfet.Hc\xc7M\x8d$\x81A\x8b\x04$9\xc7t\x1cHc\xd0M\x8d\x0c\x91A\x8b99\xf8t\n\xe8\xc9\xf4\xff\xffA\x89\x01\x89\xc7A\x89<$\x89}\x00D9\xc7\x0f\x85\x96\x01\x00\x00H\x8b\x05E\x04\x00\x00\x8b\x0c\x98B\x8b\x14\x989\xd1\x0f\x8d\xde\x00\x00\x00D\x8b\rK\x04\x00\x00)\xca1\xc0E1\xdbH\x8b\r\x19\x04\x00\x00H\x8b=\n\x04\x00\x00A\x83\xf9\x01\x0f\x855\x01\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00\x0f\xa3\xc2s\x0c\x01\xc6Hc\xf6L\x03\x1c\xf1\x8b4\xb7\x83\xc0\x01\x83\xf8\x14u\xe7D\x89\xd0Lc\xd6\x89\xc6A9\xf2t|D\x8b-\xf7\x03\x00\x00H\x8b\x1d\xc4\x03\x00\x00\xb8\x13\x00\x00\x00H\x8b-\xc0\x03\x00\x00A\x83\xfd\x01\x0f\x85\x85\x00\x00\x00f\x0f\x1fD\x00\x00B\x8d\x0c\x10\x8d\x140Hc\xc9Hc\xd2\x8b<\x8bD\x8b\x04\x93\x83\xff\xffA\x0f\x94\xc1A9\xf8A\x0f\x94\xc4E\x08\xe1u\x19A\x83\xf8\xfft\x13H\x8bL\xcd\x00H\x03L\xd5\x00D\x89\xc6Lc\xd7I\x01\xcb\x83\xe8\x01s\xbbHc\xf6N\x03\\\xd5\x00L\x03\\\xf5\x00[L\x89\xd8]A\\A]A^\xc3f\x90A\xbb\x00\x00\x00\x00\x0f\x84e\xff\xff\xff\x89\xf0D\x89\xd6A\x89\xc2\x89\xd0\x89\xca\x89\xc1\xe9\x03\xff\xff\xffC\x8dD\xed\x00A\xb9\x14\x00\x00\x00A\x8dLE\x00\x90B\x8d\x04\x11\x8d\x141H\x98Hc\xd2\x8b<\x83D\x8b\x04\x93D9\xc7A\x0f\x94\xc4\x83\xff\xffA\x0f\x94\xc6E\x08\xf4u\x19A\x83\xf8\xfft\x13H\x8bT\xd5\x00H\x03T\xc5\x00D\x89\xc6Lc\xd7I\x01\xd3D)\xe9A\x83\xe9\x01u\xb8\xe9h\xff\xff\xffE1\xc0\x0f\xa3\xc2s\rD\x01\xc6Hc\xf6L\x03\x1c\xf1\x8b4\xb7\x83\xc0\x01E\x01\xc8\x83\xf8\x14u\xe3\xe9\xc7\xfe\xff\xffI\xc7\xc3\xff\xff\xff\xff\xe9D\xff\xff\xfff\x90AW1\xc0AVAUATL\x8d%\xb7\x02\x00\x00UL\x89\xe7SH\x83\xec(H\x8b\x15\x1f\xf1\xff\xffH\x8dl$\x18H\x89\xee\xff\xd2\x8bD$\x18H\x89\xeeH\x8b\x15\x07\xf1\xff\xffL\x89\xe7\x89\x05\x82\x02\x00\x001\xc0\xff\xd2\x8bD$\x18\x89\x05p\x02\x00\x001\xc0\xe8\x19\xf1\xff\xffHc=f\x02\x00\x00H\x8b\x05\x03\xf1\xff\xffH\xc1\xe7\x02\xff\xd0H\x8b\x15\xf6\xf0\xff\xffH\x89\x05/\x02\x00\x00Hc\x05D\x02\x00\x00H\x8d<\x80H\xc1\xe7\x05\xff\xd2H\x8b\x15\xd7\xf0\xff\xffH\x89\x05\x08\x02\x00\x00Hc\x05%\x02\x00\x00H\x8d<\x80H\xc1\xe7\x04\xff\xd2H\x8b\x15\xb8\xf0\xff\xffH\x89\x05\xe1\x01\x00\x00Hc\x05\x06\x02\x00\x00H\x8d<@H\xc1\xe7\x03\xff\xd2\x8b\x15\xf6\x01\x00\x00H\x89\x05\xbb\x01\x00\x00\x85\xd2\x0f\x8e\x96\x00\x00\x00E1\xedH\x8b\x15\xc1\x01\x00\x00\xbf@\x00\x00\x00D\x89\xebB\xc7\x04\xaa\x00\x00\x00\x00K\x8dTm\x00L\x8d4\xd0H\x8b\x05a\xf0\xff\xff\xff\xd0f\x0fo\x05\xdf\x01\x00\x00H\x8b=\x80\x01\x00\x001\xc9I\x89\x06H\x8b5|\x01\x00\x00\x8b\x05\x9a\x01\x00\x00A\x0f\x11F\x08\x90\x0f\xaf\xc1\x01\xd8H\x98\xc7\x04\x87\xff\xff\xff\xff\x8b\x05\x80\x01\x00\x00\x89\xc2\x0f\xaf\xd1\x83\xc1\x01\x01\xdaHc\xd2H\xc7\x04\xd6\x00\x00\x00\x00\x83\xf9\x14u\xd2I\x83\xc5\x01D9\xe8~\x0cH\x8b\x05"\x01\x00\x00\xe9m\xff\xff\xff\x8b\x05G\x01\x00\x00E1\xedE1\xf6\x85\xc0\x7fX\xe9\xf4\x00\x00\x00\x0f\x1f\x84\x00\x00\x00\x00\x00A\x83\xff\x02u4\x89\xd6\x89\xdf\xe8\x11\xfc\xff\xffH\x8b\x15\xa2\xef\xff\xffH\x8d=#\x01\x00\x00H\x89\xc6H\x89\xc31\xc0\xff\xd2Hc5\x06\x01\x00\x00H\x8d\x04\x1eH\x99H\xf7\xfeI\x89\xd6A\x83\xc5\x01D9-\xeb\x00\x00\x00\x0f\x8e\xa1\x00\x00\x00H\x8b\x15^\xef\xff\xffH\x89\xeeL\x89\xe71\xc0\xff\xd2H\x8b\x15M\xef\xff\xffH\x89\xeeL\x89\xe7D\x8b|$\x181\xc0\xff\xd2\x8b\\$\x18H\x8b\x153\xef\xff\xffH\x89\xeeL\x89\xe71\xc0\xff\xd2Hc\xc3Hc5\xa3\x00\x00\x00L\x01\xf0H\x99H\xf7\xfeHcD$\x18L\x01\xf0\x89\xd3H\x99H\xf7\xfeA\x83\xff\x01\x0f\x85N\xff\xff\xff\x89T$\x0cH\x89\xeeH\x8b\x15\xf0\xee\xff\xff1\xc0H\x8d=r\x00\x00\x00A\x83\xc5\x01\xff\xd2H\x8bT$\x18\x8bt$\x0c\x89\xdf\xe8Q\xf8\xff\xffD9-J\x00\x00\x00\x0f\x8f_\xff\xff\xffH\x83\xc4([]A\\A]A^A_\xc3\x0f\x1fD\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00%d\x00%lld\x00%lld\n\x00f.\x0f\x1f\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00GCC: (Debian 11.2.0-10) 11.2.0\x00\x14\x00\x00\x00\x00\x00\x00\x00\x01zR\x00\x01x\x10\x01\x1b\x0c\x07\x08\x90\x01\x00\x004\x00\x00\x00\x1c\x00\x00\x000\xee\xff\xff\xf6\x00\x00\x00\x00B\x0e\x10\x8d\x02B\x0e\x18\x8c\x03A\x0e \x86\x04A\x0e(\x83\x05D\x0e0\x02\xe5\x0e(A\x0e A\x0e\x18B\x0e\x10B\x0e\x08$\x00\x00\x00T\x00\x00\x00\xf8\xee\xff\xff\x92\x00\x00\x00\x00A\x0e\x10\x86\x02A\x0e\x18\x83\x03D\x0e \x02\x89\x0e\x18A\x0e\x10A\x0e\x08D\x00\x00\x00|\x00\x00\x00p\xef\xff\xff\x93\x00\x00\x00\x00B\x0e\x10\x8f\x02E\x0e\x18\x8e\x03B\x0e \x8d\x04B\x0e(\x8c\x05A\x0e0\x86\x06A\x0e8\x83\x07D\x0e@\x02w\x0e8A\x0e0A\x0e(B\x0e B\x0e\x18B\x0e\x10B\x0e\x08H\x00\x00\x00\xc4\x00\x00\x00\xc8\xef\xff\xff\xab\x01\x00\x00\x00B\x0e\x10\x8f\x02E\x0e\x18\x8e\x03E\x0e \x8d\x04B\x0e(\x8c\x05D\x0e0\x86\x06A\x0e8\x83\x07D\x0e@\x03:\x01\n\x0e8N\x0e0G\x0e(B\x0e B\x0e\x18B\x0e\x10B\x0e\x08B\x0bH\x00\x00\x00\x10\x01\x00\x00,\xf1\xff\xffU\x05\x00\x00\x00B\x0e\x10\x8f\x02K\x0e\x18\x8e\x03B\x0e \x8d\x04B\x0e(\x8c\x05A\x0e0\x86\x06A\x0e8\x83\x07G\x0e\xc0\x02\x030\x05\x0e8A\x0e0A\x0e(B\x0e B\x0e\x18B\x0e\x10B\x0e\x08\x00\x00H\x00\x00\x00\\\x01\x00\x00@\xf6\xff\xff\xed\x02\x00\x00\x00B\x0e\x10\x8f\x02B\x0e\x18\x8e\x03B\x0e \x8d\x04B\x0e(\x8c\x05A\x0e0\x86\x06A\x0e8\x83\x07G\x0ep\x03\xd1\x02\x0e8A\x0e0A\x0e(B\x0e B\x0e\x18B\x0e\x10B\x0e\x08\x00\x00\x00<\x00\x00\x00\xa8\x01\x00\x00\xe4\xf8\xff\xffN\x02\x00\x00\x00I\x0e\x10\x8e\x02B\x0e\x18\x8d\x03B\x0e \x8c\x04A\x0e(\x86\x05A\x0e0\x83\x06\x03\x84\x01\n\x0e(D\x0e B\x0e\x18B\x0e\x10B\x0e\x08C\x0b\x00\x00H\x00\x00\x00\xe8\x01\x00\x00\xf4\xfa\xff\xff\x8b\x02\x00\x00\x00B\x0e\x10\x8f\x02D\x0e\x18\x8e\x03B\x0e \x8d\x04B\x0e(\x8c\x05H\x0e0\x86\x06D\x0e8\x83\x07D\x0e`\x03f\x02\x0e8A\x0e0A\x0e(B\x0e B\x0e\x18B\x0e\x10B\x0e\x08\x00\x00\x00'
)

libc_relocs: dict[str, int] = dict(
    scanf=0x0,
    printf=0x8,
    memcpy=0x10,
    free=0x18,
    realloc=0x20,
    malloc=0x28,
)

func_offs: int = 0xec0

libc = ctypes.CDLL("libc.so.6")

for name, offs in libc_relocs.items():
    ctypes_func: ctypes._FuncPointer = getattr(libc, name)
    ctypes_func_addr: int = ctypes.c_void_p.from_address(ctypes.addressof(ctypes_func)).value
    
    func_code[offs:offs + 8] = struct.pack("<Q", ctypes_func_addr)
    # print(f"{name} -> {ctypes_func_addr:#x}")
    del ctypes_func, ctypes_func_addr

assert len(func_code) <= 8 * mmap.PAGESIZE, "Payload too big"

# print(func_code.hex())

func_buf = mmap.mmap(-1, len(func_code), prot=mmap.PROT_READ | mmap.PROT_WRITE | mmap.PROT_EXEC)
func_ptr = ctypes.c_void_p.from_buffer(func_buf, func_offs)
func_type = ctypes.CFUNCTYPE(
    None,
)
func = func_type(ctypes.addressof(func_ptr))
func_buf.write(func_code)

# breakpoint()

# Magic
func()